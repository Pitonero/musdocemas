CREATE TABLE mesa_apuesta (
    id INT AUTO_INCREMENT PRIMARY KEY,       -- ID único para cada registro
    fecha DATETIME NOT NULL,                 -- Fecha y hora del evento
    mesa_id INT NOT NULL,                    -- Identificador único de la mesa
    jugadores VARCHAR(255) NOT NULL,         -- Lista de jugadores en formato "1,2,3,4"
    partida_id INT NOT NULL,                 -- Identificador de la partida al mejor de 2 o 3 juegos
    juego_id INT NOT NULL,                   -- Identificador del juego hasta los 40 puntos
    ronda_id INT NOT NULL,                   -- Identificador de la ronda dentro del juego
    lance_id INT NOT NULL,                   -- Identificador del lance (1=Grande, 2=Chica, etc.)
    apuesta_id INT NOT NULL,                 -- Secuencia de apuestas dentro del lance
    jugador_id INT NOT NULL,                 -- Jugador que realiza la apuesta
    accion INT NOT NULL,                     -- Acción tomada (1=Pasar, 2=Envidar, etc.)
    cantidad INT DEFAULT NULL,               -- Cantidad apostada (si aplica)
    resultado INT NOT NULL                   -- Resultado (1=Veo, 2=Paso, 3=Órdago)
);


INSERT INTO mesa_apuesta (fecha, mesa_id, jugadores, partida_id, juego_id, ronda_id, lance_id, apuesta_id, jugador_id, accion, cantidad, resultado)
VALUES 
    ('2024-12-12 10:00:00', 1, '1,2,3,4', 1, 1, 1, 1, 1, 1, 1, NULL, 2),  -- Jugador 1 pasa
    ('2024-12-12 10:01:00', 1, '1,2,3,4', 1, 1, 1, 1, 2, 2, 2, 2, 1),     -- Jugador 2 envida 2
    ('2024-12-12 10:02:00', 1, '1,2,3,4', 1, 1, 1, 1, 3, 3, 1, NULL, 2),  -- Jugador 3 pasa
    ('2024-12-12 10:03:00', 1, '1,2,3,4', 1, 1, 1, 1, 4, 4, 3, NULL, 1);  -- Jugador 4 ve

Obtener el historial de una mesa:
SELECT * FROM mesa_apuesta
WHERE mesa_id = 1
ORDER BY fecha;

Resumen de la partida:
SELECT 
    partida_id, juego_id, ronda_id, lance_id, 
    COUNT(*) AS total_apuestas
FROM mesa_apuesta
WHERE mesa_id = 1
GROUP BY partida_id, juego_id, ronda_id, lance_id;


Acciones de un jugador específico:
SELECT * FROM mesa_apuesta
WHERE mesa_id = 1 AND jugador_id = 2
ORDER BY fecha;


ugerencias Adicionales
Formato de la Lista de Jugadores:

Puedes usar un formato JSON (["1", "2", "3", "4"]) para facilitar integraciones con sistemas modernos.
Validación de Datos en el Backend:

Usa un backend (por ejemplo, Flask) para asegurarte de que los datos son coherentes antes de insertarlos en la base de datos.
Por ejemplo:
Si el jugador pasa, la cantidad debe ser NULL.
Solo los jugadores válidos (1, 2, 3, 4) pueden realizar acciones.


Ejemplo de Backend en Flask

from flask import Flask, request, jsonify
from datetime import datetime
import mysql.connector

app = Flask(__name__)

# Configuración de la base de datos
db_config = {
    'user': 'tu_usuario',
    'password': 'tu_contraseña',
    'host': 'localhost',
    'database': 'mus_juego'
}

@app.route('/apuesta', methods=['POST'])
def registrar_apuesta():
    data = request.json
    conn = mysql.connector.connect(**db_config)
    cursor = conn.cursor()
    
    query = """
    INSERT INTO mesa_apuesta (fecha, mesa_id, jugadores, partida_id, juego_id, ronda_id, lance_id, apuesta_id, jugador_id, accion, cantidad, resultado)
    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    """
    valores = (
        datetime.now(), data['mesa_id'], data['jugadores'], data['partida_id'], 
        data['juego_id'], data['ronda_id'], data['lance_id'], data['apuesta_id'], 
        data['jugador_id'], data['accion'], data.get('cantidad'), data['resultado']
    )
    cursor.execute(query, valores)
    conn.commit()
    cursor.close()
    conn.close()

    return jsonify({"message": "Apuesta registrada exitosamente"}), 201


Este diseño es sencillo, escalable, y te permite gestionar todos los eventos del juego de Mus desde una única tabla.


