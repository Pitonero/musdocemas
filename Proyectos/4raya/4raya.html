<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4 en Raya</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: Arial, sans-serif;
    margin-top: 20px;
  }
  .board {
    display: grid;
    grid-template-columns: repeat(7, 50px);
    grid-template-rows: repeat(6, 50px);
    gap: 5px;
  }
  .cell {
    width: 50px;
    height: 50px;
    background-color: #007BFF;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
  .red {
    background-color: red;
  }
  .yellow {
    background-color: yellow;
  }
  .message {
    margin-top: 20px;
    font-size: 1.5em;
  }
</style>
</head>
<body>

<div class="board" id="board"></div>
<div class="message" id="message">Turno de Rojo</div>

<script>
const rows = 6;
const cols = 7;
const board = [];
let currentPlayer = 'red';

function createBoard() {
  const boardElement = document.getElementById('board');
  for (let row = 0; row < rows; row++) {
    const rowArray = [];
    for (let col = 0; col < cols; col++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.row = row;
      cell.dataset.col = col;
      cell.addEventListener('click', placePiece);
      boardElement.appendChild(cell);
      rowArray.push(null);
    }
    board.push(rowArray);
  }
}

function placePiece(event) {
  const col = parseInt(event.target.dataset.col);
  for (let row = rows - 1; row >= 0; row--) {
    if (!board[row][col]) {
      board[row][col] = currentPlayer;
      event.target.style.backgroundColor = currentPlayer;
      if (checkWin(row, col)) {
        document.getElementById('message').textContent = `¡${currentPlayer.toUpperCase()} GANA!`;
        disableBoard();
        return;
      }
      if (isBoardFull()) {
        document.getElementById('message').textContent = '¡EMPATE!';
        return;
      }
      currentPlayer = currentPlayer === 'red' ? 'yellow' : 'red';
      document.getElementById('message').textContent = `Turno de ${currentPlayer.toUpperCase()}`;
      return;
    }
  }
}

function checkWin(row, col) {
  const directions = [
    { dx: 0, dy: 1 },  // Horizontal
    { dx: 1, dy: 0 },  // Vertical
    { dx: 1, dy: 1 },  // Diagonal /
    { dx: 1, dy: -1 }  // Diagonal \
  ];

  for (const direction of directions) {
    let count = 1;
    for (let i = 1; i < 4; i++) {
      const newRow = row + direction.dy * i;
      const newCol = col + direction.dx * i;
      if (newRow >= 0 && newRow < rows && newCol >= 0 && newCol < cols && board[newRow][newCol] === currentPlayer) {
        count++;
      } else {
        break;
      }
    }
    for (let i = 1; i < 4; i++) {
      const newRow = row - direction.dy * i;
      const newCol = col - direction.dx * i;
      if (newRow >= 0 && newRow < rows && newCol >= 0 && newCol < cols && board[newRow][newCol] === currentPlayer) {
        count++;
      } else {
        break;
      }
    }
    if (count >= 4) {
      return true;
    }
  }
  return false;
}

function isBoardFull() {
  for (let row = 0; row < rows; row++) {
    for (let col = 0; col < cols; col++) {
      if (!board[row][col]) {
        return false;
      }
    }
  }
  return true;
}

function disableBoard() {
  const cells = document.querySelectorAll('.cell');
  cells.forEach(cell => cell.removeEventListener('click', placePiece));
}

createBoard();
</script>

</body>
</html>